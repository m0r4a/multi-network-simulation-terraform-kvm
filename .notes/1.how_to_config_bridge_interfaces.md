# Configurar las interfaces `bridge`

## La interfaz bridge en la host machine

La interfaz tiene que realmente existir en algún lado, estas son máquinas virtuales no servidores remotos entonces hay que tener la interfaz creada y levantada en la máquina host para que las VMs puedan comunicarse.

```bash
sudo ip link add name <nombre-del-bridge> type bridge
sudo ip link set <nomble-del-bridge> up
```

## Network manager

Como Rocky Linux usa `Network Manager` la configuración de las interfaces se hace en `/etc/NetworkManager/system-connections/*`.

### Configurando la interfaz

En `systems-connections` pones un nomble con el formato `algo.nmconnection`   *(parece que la recomendación es <nombre_de_interfaz.nmconnection>)* y creas un archivo masomenos así:

```
[connection]
id=ejemplo  # Este va a ser el id que se usará en nmcli connection < >
type=ethernet
interface-name=<la interfaz>
autoconnect=true

[ipv4]
method=manual
addresses=<ip propia>/<bits>  # Está en cdir
gateway=<ip del gateway>      # Si no hay no se pone
dns=<ip>                      # Opcional

[ipv6]
method=ignore
```

### Activando la configuración

```
sudo chmod 600 /etc/NetworkManager/system-connections/<algo>.nmconnection
sudo nmcli connection reload
sudo nmcli connection up <el id que pusiste en el archivo>
```

*Nota: si te dice que no existe esa conexión probablemente hay un error en el archivo*

**IMPORTANTE: Si tienes algún error asegurate de que los permisos sí estén en 600**

### Extra

1. Si sospechas que es un problema de que por alguna razón la interfaz no puede tomar una IP prueba a asignarle una de forma imperativa

```
sudo ip link set <interfaz> up
sudo ip addr add <la ip que quieres tomar con su /cdir> dev <interfaz>
```

- Si da un error de “file exists” o “RTNETLINK: File exists”, significa que ya hay una ruta o IP duplicada.

- Si da un error “Invalid argument”, revisa que estés usando /30 sobre el dispositivo correcto.
